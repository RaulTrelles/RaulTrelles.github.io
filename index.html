<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./style/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-K9XLGD2PPM"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-K9XLGD2PPM');
    </script>

    <script>
        document.cookie = "key=value; SameSite=None; Secure";
    </script>

    <!-- CONFIGURACI√ìN BOTPRESS M√ÅS SIMPLE Y EFECTIVA -->
    <script>
        // Configuraci√≥n m√≠nima pero efectiva
        window.botpressWebChatInit = {
            botId: "9c0wy3ho",
            hostUrl: "https://cdn.botpress.cloud/webchat/v2.2",
            clientId: "9c0wy3ho",

            // ESTO ES LO M√ÅS IMPORTANTE - Configurar para que inicie ABIERTO
            layout: {
                initialOpen: true,  // Iniciar abierto
                isOpen: true        // Estado abierto
            },

            // Configuraci√≥n del comportamiento
            hideWidget: false,
            showConversationsButton: false,

            // Callback cuando se carga - ESTO ES CLAVE
            onLoad: function (bp) {
                console.log('üîµ Botpress cargado, API disponible');

                // Guardar la instancia para uso global
                window.botpressInstance = bp;

                // Forzar que el chat est√© abierto
                setTimeout(function () {
                    console.log('üîÑ Forzando apertura del chat...');

                    // M√©todo 1: Usar el m√©todo open si existe
                    if (typeof bp.open === 'function') {
                        bp.open();
                        console.log('‚úÖ Chat abierto usando bp.open()');
                    }
                    // M√©todo 2: Usar sendEvent
                    else if (bp.webchat && typeof bp.webchat.sendEvent === 'function') {
                        bp.webchat.sendEvent({ type: 'show' });
                        console.log('‚úÖ Chat abierto usando sendEvent');
                    }
                    // M√©todo 3: Configurar estado directamente
                    else {
                        console.log('‚ö†Ô∏è Usando m√©todo alternativo');
                        try {
                            // Intentar modificar el estado directamente
                            if (bp.config) {
                                bp.config.layout.isOpen = true;
                            }
                        } catch (e) {
                            console.log('Error:', e);
                        }
                    }
                }, 1000); // Esperar 1 segundo para asegurar carga completa
            }
        };
    </script>

    <title>Portafolio Personal</title>
</head>

<body>
    <nav>
        <input type="checkbox" class="checkbox" id="check">
        <h1 class="nav_head">Ra√∫l</h1>
        <ul>
            <li><a href="#home">Inicio</a></li>
            <li><a href="#about">Acerca de</a></li>
            <li><a href="#tecnologias">Tecnolog√≠as</a></li>
            <li><a href="#portafolio">Portafolio</a></li>
            <li><a href="#experimentos">Experimentos</a></li>
            <a href="./paginas/contactame.html"><button class="contact_btn">Contactame</button></a>
        </ul>

        <label for="check" class="checkbtn">
            <i class="fas fa-bars" id="menu-icon"></i>
            <i class="fas fa-times" id="close-icon" style="display: none;"></i>
        </label>
    </nav>

    <section id="home" class="home">
        <img src="./img/ratv.svg" alt="" width="550px" height="450px">
        <div class="description">
            <h1>Hola, te saluda <br><span> Ra√∫l Trelles </span></h1>
            <h2><span>Hagamos que los datos y los sistemas hablen ... </span></h2>
            <P>Un apasionado por la tecnolog√≠a, disfruto implementando soluciones que ayuden a generar valor,
                ahorro y oportunidades en las organizaciones, haciendo uso de la tecnolog√≠a .</P>
            <div class="font">
                <i class="fa-brands fa-instagram icon-disabled"></i>
                <i class="fa-brands fa-facebook icon-disabled"></i>
                <a href="https://www.linkedin.com/in/raultrelles/" target="_blank" rel="noopener noreferrer">
                    <i class="fa-brands fa-linkedin-in"></i>
                </a>
            </div>

            <button id="downloadBtnabout" class="form_btn">Portafolio...</button>

            <script>
                document.getElementById('downloadBtnabout').addEventListener('click', function () {
                    location.href = '#portafolio';
                });
            </script>

        </div>
    </section>
    <section id="about" class="about">
        <div class="about_section">
            <h1>Acerca <span>de mi</span></h1>
            <h2>Soy un Especialista en Desarrollo e Implementaci√≥n de Sistemas y <span>Anal√≠tica de Datos</span></h2>
            <p>Ingeniero de Sistemas y C√≥mputo, MBA con √©nfasis en Business Intelligence y Big Data, Certificado en
                Scrum Master e ITIL y especialista en Gesti√≥n de Proyectos TI, con m√°s de 10 a√±os de experiencia en
                sectores como Servicios, Legal, Gobierno, Industria, Log√≠stico, Alimentario, Aduanero, Comercio
                Exterior, Energ√≠a, he liderado proyectos de desarrollo, implementaciones de sistemas CRM y ERP.
                Desarrollador Full Stack y Cient√≠fico de Datos con experiencia en desarrollo web y m√≥vil, an√°lisis de
                datos e inteligencia de negocios. Apasionado por crear soluciones que generen valor, optimizaci√≥n y
                oportunidades en las organizaciones a trav√©s de la tecnolog√≠a...</p> <br>

            <button id="downloadBtn" class="about_btn">Download CV</button>

            <script>
                document.getElementById('downloadBtn').addEventListener('click', function () {
                    window.open('https://drive.google.com/file/d/16kCg0tOBKmcj3Zp8NE6DafUZjQYY1A28/view?usp=sharing', '_blank');
                });
            </script>

        </div>
        <div class="about_photo">
            <img src="./img/ratv.svg" alt="" width="400" height="300">
        </div>
    </section>
    <section id="tecnologias" class="tecnologias">
        <h1 class="tecnologias_section">Algunas tecnolog√≠as con las que <span>Trabajo</span></h1>
        <div class="card_tec">
            <div class="tecnologias_card">
                <img src="./img/erp2.png" alt="" width="200px" height="150px">
                <h3>Gesti√≥n y Procesos</h3>
            </div>
            <div class="tecnologias_card">
                <img src="./img/analiticadatos.png" alt="" width="200px" height="150px">
                <h3>Anal√≠tica de Datos</h3>
            </div>
            <div class="tecnologias_card">
                <img src="./img/uiux.png" alt="" width="200px" height="150px">
                <h3>Dise√±o Ux/Ui</h3>
            </div>
            <div class="tecnologias_card">
                <img src="./img/backend.png" alt="" width="200px" height="150px">
                <h3>Backend</h3>
            </div>
            <div class="tecnologias_card">
                <img src="./img/developer.png" alt="" width="200px" height="150px">
                <h3>FrontEnd</h3>
            </div>

        </div>

    </section>
    <section id="portafolio" class="portafolio">
        <h1 class="port_section"><span>Portafolio</span> Reciente</h1>
        <div class="projects">
            <a href="./paginas/PortalInteligenciaNegocios.html">
                <div class="port_card">
                    <img src="./img/Power BI.png" alt="" width="400px" height="350px">
                    <div class="content">
                        <h1>Inteligencia de Negocios</h1>
                        <p>Una herramienta importante en estos timpos en las organizaciones, el manejar indicadores y
                            dashboard nos ayudan a tener una visi√≥n r√°pidamente de mi organizaci√≥n, conoce algunos de
                            mis proyectos...</p>
                    </div>
                </div>
            </a>

            <a href="./paginas/PortalERP.html">
                <div class="port_card">
                    <img src="./img/erp.png" alt="" width="400px" height="350px">
                    <div class="content">
                        <h1>Implementador ERP's</h1>
                        <p>Desarrollo una metodolog√≠a que asegura que tu implementaci√≥n tenga el √©xito deseado,
                            brindando un escenario en donde la alta gerencia obtiene los indicadores deseados y los
                            usuarios est√°n felices...</p>
                    </div>
                </div>
            </a>

            <a href="./paginas/PortalFullStack.html">
                <div class="port_card">
                    <img src="./img/developer.png" alt="" width="400px" height="350px">
                    <div class="content">
                        <h1>Desarrollo e Implementaci√≥n <br>
                            de Sistemas - Full Stack Developer</h1>
                        <p>El conocer tecnolog√≠as de BackEnd y FrontEnd me permiten afrontar un proyecto integralmente
                            complementando con el dise√±o, te invito a conocer mis √∫ltimos proyectos...</p>
                    </div>
                </div>
            </a>


        </div>

    </section>
    <section id="experimentos" class="Experimentos">
        <h1 class="exper_section"><span>Algunos </span> Experimentos</h1>
        <div class="exper">

            <div class="exper_card" id="1">
                <a href="https://codepen.io/CreativeCoder111/pen/XWyjBab" target="_blank" rel="noopener noreferrer">
                    <img src="./img/experimentos/experimento1.png" alt="" width="400px" height="350px">
                    <div class="content">
                        <h1>Carrucel CCS3 y JS</h1>
                    </div>
                </a>
            </div>

            <div class="exper_card" id="2">
                <a href="https://www.figma.com/design/VqSfwfs8t9WPu819F6OFzI/Untitled?node-id=0-1&t=DVwkHo8mPk43pt0D-1"
                    target="_blank" rel="noopener noreferrer">
                    <img src="./img/experimentos/experimento5.png" alt="" width="400px" height="350px">
                    <div class="content">
                        <h1>Dise√±o Figma de Portal</h1>
                        <h1>Portafolio Personal</h1>

                    </div>
                </a>
            </div>

        </div>

    </section>

    <div class="footer">
        <p><i class="fa-solid fa-copyright"></i>Ra√∫l Trelles. || All Right Reserved... </p>
    </div>

    <div id="modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div id="modal-body">
                <!-- El contenido del modal ir√° aqu√≠, cambiar√° din√°micamente -->
            </div>
        </div>
    </div>
    <script src="./js/script.js"></script>

    <!-- Cargar Botpress -->
    <script src="https://cdn.botpress.cloud/webchat/v2.2/inject.js"></script>
    <script src="https://files.bpcontent.cloud/2025/01/14/04/20250114041029-9C0WY3HO.js"></script>

    <!-- SOLUCI√ìN FINAL - SIN POSTMESSAGE -->
    <script type="text/javascript">
        console.log('=== SOLUCI√ìN FINAL SIN POSTMESSAGE ===');

        // Variable para controlar si ya se abri√≥
        let chatOpened = false;

        // Funci√≥n simple y directa para abrir el chat
        function openChatSimple() {
            if (chatOpened) return;

            console.log('üîì Intentando abrir chat de forma simple...');

            // M√âTODO PRINCIPAL: Usar window.botpressWebChatInit.onLoad callback
            if (window.botpressInstance) {
                console.log('‚úÖ Usando botpressInstance del callback');
                try {
                    // M√©todo preferido: bp.open()
                    if (typeof window.botpressInstance.open === 'function') {
                        window.botpressInstance.open();
                        chatOpened = true;
                        console.log('üéâ Chat abierto usando botpressInstance.open()');
                        return true;
                    }
                    // M√©todo alternativo: webchat.sendEvent
                    else if (window.botpressInstance.webchat &&
                        typeof window.botpressInstance.webchat.sendEvent === 'function') {
                        window.botpressInstance.webchat.sendEvent({ type: 'show' });
                        chatOpened = true;
                        console.log('üéâ Chat abierto usando webchat.sendEvent');
                        return true;
                    }
                } catch (e) {
                    console.log('‚ùå Error con botpressInstance:', e);
                }
            }

            // M√âTODO ALTERNATIVO: Buscar el iframe del webchat y modificar sus clases
            console.log('üîÑ Intentando m√©todo alternativo...');
            const webchatIframe = document.querySelector('iframe.bpWebchat');

            if (webchatIframe) {
                console.log('‚úÖ Encontrado iframe bpWebchat');

                // Remover clase que lo oculta (bpClose)
                if (webchatIframe.classList.contains('bpClose')) {
                    webchatIframe.classList.remove('bpClose');
                    console.log('üìå Clase bpClose removida');
                }

                // Asegurar que est√© visible
                webchatIframe.style.display = 'block';
                webchatIframe.style.visibility = 'visible';
                webchatIframe.style.opacity = '1';
                webchatIframe.style.zIndex = '999999';

                chatOpened = true;
                console.log('üé® Chat forzado a ser visible mediante CSS');
                return true;
            }

            console.log('‚ö†Ô∏è No se pudo abrir el chat en este intento');
            return false;
        }

        // Funci√≥n para verificar el estado actual
        function checkCurrentStatus() {
            console.log('üìä Estado actual:');

            // Verificar instancia
            console.log('- window.botpressInstance:', !!window.botpressInstance);

            // Verificar iframes
            const iframes = document.querySelectorAll('iframe');
            console.log('- Total iframes:', iframes.length);

            iframes.forEach((iframe, i) => {
                console.log(`  Iframe ${i}: ${iframe.className} ${iframe.classList.contains('bpClose') ? '(cerrado)' : '(abierto)'}`);
            });

            // Verificar chat abierto
            const webchatIframe = document.querySelector('iframe.bpWebchat:not(.bpClose)');
            console.log('- Chat visible:', !!webchatIframe);

            return {
                instance: !!window.botpressInstance,
                chatVisible: !!webchatIframe,
                iframes: iframes.length
            };
        }

        // Iniciar proceso de apertura autom√°tica
        function startAutoOpenProcess() {
            console.log('üöÄ Iniciando proceso de auto-apertura');

            // Verificar estado inicial
            checkCurrentStatus();

            // Intentar abrir inmediatamente
            setTimeout(openChatSimple, 500);

            // Intentar varias veces (estrategia agresiva pero necesaria)
            const attempts = [1000, 1500, 2000, 3000, 5000, 8000, 12000, 20000];

            attempts.forEach((delay, index) => {
                setTimeout(() => {
                    if (!chatOpened) {
                        console.log(`üîÑ Intento ${index + 2} (${delay}ms)`);
                        openChatSimple();
                    }
                }, delay);
            });

            // Verificaci√≥n final
            setTimeout(() => {
                if (!chatOpened) {
                    console.log('‚è∞ Verificaci√≥n final despu√©s de 25 segundos');
                    const status = checkCurrentStatus();

                    if (!status.chatVisible) {
                        console.log('‚ö†Ô∏è EL CHAT NO SE ABRI√ì AUTOM√ÅTICAMENTE');
                        console.log('üí° Posibles soluciones:');
                        console.log('   1. Verifica la configuraci√≥n en botpress.cloud');
                        console.log('   2. Aseg√∫rate de que el bot est√© publicado');
                        console.log('   3. Revisa la consola de errores');
                    }
                }
            }, 25000);
        }

        // Iniciar cuando el DOM est√© listo
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', function () {
                console.log('üìÑ DOM cargado, iniciando en 1 segundo...');
                setTimeout(startAutoOpenProcess, 1000);
            });
        } else {
            console.log('üìÑ DOM ya cargado, iniciando en 1 segundo...');
            setTimeout(startAutoOpenProcess, 1000);
        }

        // Manejar el men√∫ responsive
        document.getElementById('check').addEventListener('change', function () {
            const menuIcon = document.getElementById('menu-icon');
            const closeIcon = document.getElementById('close-icon');
            if (this.checked) {
                menuIcon.style.display = 'none';
                closeIcon.style.display = 'inline';
            } else {
                menuIcon.style.display = 'inline';
                closeIcon.style.display = 'none';
            }
        });

        // Exponer funciones √∫tiles para depuraci√≥n
        window.openChatManual = openChatSimple;
        window.checkStatus = checkCurrentStatus;
        window.forceOpen = function () {
            console.log('üõ†Ô∏è Forzando apertura manual...');
            chatOpened = false;
            openChatSimple();
        };

        console.log('üîß Comandos disponibles en consola:');
        console.log('   openChatManual() - Abrir chat manualmente');
        console.log('   checkStatus() - Verificar estado actual');
        console.log('   forceOpen() - Forzar apertura (reinicia intento)');

        // Si el callback onLoad no se ejecuta, intentar detectar Botpress de otra forma
        setTimeout(function () {
            if (!window.botpressInstance) {
                console.log('üïµÔ∏è‚Äç‚ôÇÔ∏è Buscando Botpress de forma alternativa...');

                // Verificar si window.botpress existe
                if (window.botpress) {
                    console.log('‚úÖ Encontrado window.botpress');
                    window.botpressInstance = window.botpress;
                    openChatSimple();
                }
                // Verificar si hay alg√∫n iframe de Botpress
                else if (document.querySelector('iframe[class*="bp"]')) {
                    console.log('‚úÖ Iframes de Botpress detectados');
                    openChatSimple();
                }
            }
        }, 3000);
    </script>

</body>

</html>